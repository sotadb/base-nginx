{
	consul: "localhost:8500",
	jobs: [
		{
			name: "consul-agent",
			exec: ["/usr/bin/consul", "agent", "-config-dir=/etc/consul"],
			restarts: "unlimited",
			health: { exec: ["/usr/bin/consul-manage", "health"], interval: 10, ttl: 25 }
		},
		{
			name: "nginx-setup",
			exec: ["/usr/bin/consul-template", "-once", "-template", "/etc/nginx/nginx.hcl:/etc/nginx/nginx.conf" ],
			when: { source: "consul-agent", once: "healthy" }
		},
		{
			name: "nginx",
			port: 80,
			exec: ["/usr/bin/nginx"],
			when: { source: "nginx-setup", once: "exitSuccess" },
			health: { exec: ["/usr/bin/curl", "--fail", "-o", "/dev/null", "http://localhost/nginx-health"], interval: 5, ttl: 5, timeout: "4s" }
		},
		{
			name: "onChange-consul"
			exec: ["/usr/bin/consul-template", "-once", "-template", "/etc/nginx/nginx.hcl:/etc/nginx/nginx.conf:/usr/bin/nginx -s reload"],
			when: { source: "watch.consul", each: "changed" }
		},
		{
			name: "preStop",
			exec: ["consul", "leave"],
			when: { source: "consul", once: "stopping" }
		}
	],
	watches: [
		{ name: "consul", interval: 3 }
	]
}
