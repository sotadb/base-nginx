{
	consul: "localhost:8500",
	jobs: [
		{
			name: "consul-agent",
			exec: ["consul", "agent", "-ui", "-config-dir=/etc/consul"],
			health: {exec: "consul-check", interval: 5, ttl: 5, timeout: "4s"},
			restarts: "unlimited"
		},
		{
			name: "preStop",
			exec: ["consul", "leave"],
			when: { source: "consul-agent", once: "stopping" }
		},
		{	name: "acme-init",
			exec: ["/usr/bin/acme-manage", "init"]
			when: { source: "consul-agent", once: "healthy" },
		},
		{
			name: "nginx",
			port: 80,
			exec: ["/usr/bin/consul-template", "-exec", "/usr/sbin/nginx", "-template", "/etc/nginx/nginx.hcl:/etc/nginx/nginx.conf" ],
			when: { source: "acme-init", once: "exitSuccess" },
			health: { exec: ["/usr/bin/nginx-check", "http-check"], interval: 5, ttl: 10, timeout: "4s" }
		},
		{
			name: "nginx-ssl",
			port: 443,
			when: { source: "nginx", once: "healthy" },
			health: { exec: ["/usr/bin/nginx-check", "https-check"], interval: 5, ttl: 10, timeout: "4s" }
		},
		{
			name: "onChange-acme",
			exec: ["/usr/bin/acme-manage", "watch-domains"],
			when: { source: "nginx", once: "healthy" },
			restarts: "unlimited"
		},
		{
			name: "acme",
			exec: ["/usr/bin/acme-manage", "client"], 
			when: { source: "nginx", once: "healthy" },
			restarts: "unlimited"
		}
	]
}
